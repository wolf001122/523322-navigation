<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>导航</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<meta name="google-adsense-account" content="ca-pub-9474229114991789">
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<script async
&nbsp;&nbsp;src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9474229114991789"
&nbsp;&nbsp;crossorigin="anonymous"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
&nbsp;&nbsp;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
&nbsp;&nbsp;background:#f8f9fa;
&nbsp;&nbsp;color:#202124;
&nbsp;&nbsp;height:100vh;
&nbsp;&nbsp;overflow:hidden;
}
#layout{display:flex;height:100vh;width:100vw}
/* 左侧分类 */
#sidebar{width:240px;background:#fff;border-right:1px solid #dadce0;display:flex;flex-direction:column;box-shadow:0 1px 2px 0 rgba(60,64,67,0.3),0 1px 3px 1px rgba(60,64,67,0.15);}
#logo{padding:24px 20px;font-size:24px;font-weight:700;text-align:center;color:#5f6368;border-bottom:1px solid #dadce0;transition:color 0.2s;cursor:default;position:relative;}
#logo.return-mode{color:#1a73e8;cursor:pointer;}
#logo.return-mode:hover{opacity:0.8;}
#logo.return-mode::after{content:'返回搜索首页';position:absolute;top:100%;left:50%;transform:translateX(-50%);background:#333;color:#fff;padding:4px 8px;border-radius:4px;font-size:12px;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity 0.2s;z-index:10;}
#logo.return-mode:hover::after{opacity:1;}
#cats{flex:1;overflow-y:auto;padding:8px 0;}
.cat{padding:14px 24px;cursor:pointer;font-size:15px;color:#3c4043;transition:background 0.2s;}
.cat:hover{background:#f1f3f4;}
.cat.active{background:#e8f0fe;color:#1a73e8;font-weight:500;}
#side-bottom{border-top:1px solid #dadce0;padding:16px 24px;font-size:14px;color:#5f6368;flex-shrink:0;overflow-y:auto;} /* 修复：固定底部不溢出 */
#side-bottom div{margin-bottom:12px;cursor:pointer;} /* 优化间距 */
#side-bottom div:hover{color:#1a73e8;}
/* 主区域 */
#main{flex:1;overflow-y:auto;background:#f8f9fa;}
#ad-top{background:#fff;border-bottom:1px solid #dadce0;padding:12px;text-align:center;box-shadow:0 1px 2px 0 rgba(60,64,67,0.3);}
/* 搜索页 */
#search-page{height:calc(100vh - 60px);display:flex;flex-direction:column;justify-content:center;align-items:center;padding:40px;}
#search-box{display:flex;width:100%;max-width:680px;}
#search-box input{flex:1;padding:16px 20px;font-size:18px;border:1px solid #dadce0;border-radius:28px 0 0 28px;outline:none;box-shadow:0 1px 6px rgba(32,33,36,0.28);transition:box-shadow 0.2s;}
#search-box input:focus{box-shadow:0 1px 6px rgba(32,33,36,0.38);}
#search-box button{padding:0 24px;border:1px solid #dadce0;border-left:none;border-radius:0 28px 28px 0;background:#1a73e8;color:#fff;cursor:pointer;}
#engines{margin-top:20px;display:flex;justify-content:center;gap:12px;flex-wrap:wrap;}
#engines button{padding:10px 20px;border:1px solid #dadce0;background:#fff;border-radius:24px;cursor:pointer;font-size:14px;color:#3c4043;transition:all 0.2s;}
#engines button:hover{background:#f1f3f4;box-shadow:0 1px 3px rgba(0,0,0,0.15);}
#engines button.active{background:#e8f0fe;color:#1a73e8;}
/* 内容页 */
#content{padding:24px;display:none;}
/* 广告位 */
.ad-box{margin:32px 0;padding:16px;background:#fff;border:1px solid #dadce0;border-radius:8px;text-align:center;box-shadow:0 1px 2px 0 rgba(60,64,67,0.3);}
/* 分类卡片 */
.category-title{font-size:28px;font-weight:500;color:#202124;margin-bottom:8px;}
.sub-title{font-size:18px;color:#5f6368;margin:24px 0 12px;font-weight:500;}
.links{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px;}
.card{display:flex;align-items:center;padding:16px;background:#fff;border-radius:12px;text-decoration:none;color:inherit;box-shadow:0 1px 2px 0 rgba(60,64,67,0.3),0 2px 6px 2px rgba(60,64,67,0.15);transition:all 0.2s;height:96px;}
.card:hover{box-shadow:0 4px 8px 0 rgba(60,64,67,0.3),0 8px 20px 4px rgba(60,64,67,0.15);transform:translateY(-2px);}
.card img{width:48px;height:48px;min-width:48px;min-height:48px;object-fit:contain;background:#f8f9fa;border-radius:8px;padding:4px;}
.text{margin-left:16px;overflow:hidden;}
.name{font-size:15px;font-weight:500;color:#202124;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.desc{font-size:13px;color:#5f6368;white-space:normal;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;margin-top:4px;}
/* 提交表单 */
form input, form select, form textarea{width:100%;margin:8px 0;padding:8px;}
form button{padding:10px 20px;background:#1a73e8;color:#fff;border:none;cursor:pointer;}
#captchaQuestion{font-weight:bold;margin:10px 0;color:#1a73e8;}
</style>
</head>
<body>
<div id="layout">
&nbsp;&nbsp;<div id="sidebar">
&nbsp;&nbsp;&nbsp;&nbsp;<div id="logo" onclick="backToSearch()">导　航</div>
&nbsp;&nbsp;&nbsp;&nbsp;<div id="cats"></div>
&nbsp;&nbsp;&nbsp;&nbsp;<div id="side-bottom">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div onclick="showSubmit()">网站提交</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div onclick="showPrivacy()">隐私政策</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div onclick="showLinks()">友情链接</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div onclick="showAbout()">关于导航</div>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;</div>
&nbsp;&nbsp;<div id="main">
&nbsp;&nbsp;&nbsp;&nbsp;<div id="ad-top">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<ins class="adsbygoogle" style="display:block"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data-ad-client="ca-pub-9474229114991789"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data-ad-slot="1234567890"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data-ad-format="auto"></ins>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;<div id="search-page">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div id="search-box">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input id="q" placeholder="搜索…" onkeydown="if(event.key==='Enter')go()">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="go()">搜索</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div id="engines">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button class="active" onclick="setEngine(this,'https://www.google.com/search?q=')">Google</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="setEngine(this,'https://www.baidu.com/s?wd=')">百度</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button onclick="setEngine(this,'https://www.bing.com/search?q=')">Bing</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;&nbsp;&nbsp;<div id="content"></div>
&nbsp;&nbsp;</div>
</div>
<script>
const API='/api/data';
let engine='https://www.google.com/search?q=';
let data;
const DEF_ICON='/icons/gray.png';
const logo = document.getElementById('logo');
// 提取域名函数
function getDomain(url) {
&nbsp;&nbsp;try {
&nbsp;&nbsp;&nbsp;&nbsp;const hostname = new URL(url).hostname;
&nbsp;&nbsp;&nbsp;&nbsp;return hostname.startsWith('www.') ? hostname.slice(4) : hostname;
&nbsp;&nbsp;} catch (e) {
&nbsp;&nbsp;&nbsp;&nbsp;return 'example.com';
&nbsp;&nbsp;}
}
/* ================= 分类数据 ================= */
fetch(API).then(r=>r.text()).then(t=>{
&nbsp;&nbsp;const xml=new DOMParser().parseFromString(t,'text/xml');
&nbsp;&nbsp;data=[...xml.querySelectorAll('category')].map(c=>({
&nbsp;&nbsp;&nbsp;&nbsp;name:c.getAttribute('name'),
&nbsp;&nbsp;&nbsp;&nbsp;subs:[...c.querySelectorAll('subcategory')].map(s=>({
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:s.getAttribute('name'),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;links:[...s.querySelectorAll('link')].map(l=>({
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:l.getAttribute('name'),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url:l.getAttribute('url'),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desc:l.getAttribute('desc'),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;icon:l.getAttribute('icon')
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}))
&nbsp;&nbsp;&nbsp;&nbsp;}))
&nbsp;&nbsp;}));
&nbsp;&nbsp;renderCats();
&nbsp;&nbsp;backToSearch(); // 初始状态
});
/* ================= 渲染分类 ================= */
function renderCats(){
&nbsp;&nbsp;const box=document.getElementById('cats'); box.innerHTML='';
&nbsp;&nbsp;data.forEach(c=>{
&nbsp;&nbsp;&nbsp;&nbsp;const d=document.createElement('div');
&nbsp;&nbsp;&nbsp;&nbsp;d.className='cat'; d.textContent=c.name;
&nbsp;&nbsp;&nbsp;&nbsp;d.onclick=()=>showCategory(c);
&nbsp;&nbsp;&nbsp;&nbsp;box.appendChild(d);
&nbsp;&nbsp;});
}
/* ================= 搜索 ================= */
function go(){
&nbsp;&nbsp;const q=document.getElementById('q').value.trim();
&nbsp;&nbsp;if(q) window.open(engine+encodeURIComponent(q),'_blank');
}
function setEngine(btn,url){
&nbsp;&nbsp;engine=url;
&nbsp;&nbsp;document.querySelectorAll('#engines button').forEach(b=>b.classList.remove('active'));
&nbsp;&nbsp;btn.classList.add('active');
}
/* ================= 分类页显示 + 图标逻辑 ================= */
function showCategory(c){
&nbsp;&nbsp;document.getElementById('search-page').style.display='none';
&nbsp;&nbsp;const cont=document.getElementById('content'); cont.style.display='block';
&nbsp;&nbsp;cont.innerHTML=`<div class="category-title">${c.name}</div>
&nbsp;&nbsp;&nbsp;&nbsp;<div class="ad-box">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<ins class="adsbygoogle" style="display:block"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data-ad-client="ca-pub-9474229114991789"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data-ad-slot="9876543210"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data-ad-format="auto"></ins>
&nbsp;&nbsp;&nbsp;&nbsp;</div>
&nbsp;&nbsp;`;
&nbsp;&nbsp;(adsbygoogle=window.adsbygoogle||[]).push({});
&nbsp;&nbsp;c.subs.forEach((s,i)=>{
&nbsp;&nbsp;&nbsp;&nbsp;if(!s.links.length) return;
&nbsp;&nbsp;&nbsp;&nbsp;cont.innerHTML+=`<div class="sub-title">${s.name}</div><div class="links" id="l${i}"></div>`;
&nbsp;&nbsp;&nbsp;&nbsp;const box=document.getElementById('l'+i);
&nbsp;&nbsp;&nbsp;&nbsp;s.links.forEach(l=>{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const a=document.createElement('a'); a.className='card'; a.href=l.url; a.target='_blank';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const img=document.createElement('img');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (l.icon && l.icon.trim()) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img.src = l.icon.trim();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const domain = getDomain(l.url);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img.src = `https://www.google.com/s2/favicons?sz=64&domain=${domain}`;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img.onerror = () => {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img.onerror = null;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img.src = DEF_ICON;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const t=document.createElement('div'); t.className='text';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.innerHTML=`<div class="name">${l.name}</div><div class="desc">${l.desc||''}</div>`;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.appendChild(img); a.appendChild(t); box.appendChild(a);
&nbsp;&nbsp;&nbsp;&nbsp;});
&nbsp;&nbsp;&nbsp;&nbsp;if(i===0){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cont.innerHTML+=`<div class="ad-box">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<ins class="adsbygoogle" style="display:block"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data-ad-client="ca-pub-9474229114991789"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data-ad-slot="1122334455"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data-ad-format="auto"></ins></div>`;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(adsbygoogle=window.adsbygoogle||[]).push({});
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;});
&nbsp;&nbsp;logo.classList.add('return-mode');
}
/* ================= 返回搜索首页 ================= */
function backToSearch(){
&nbsp;&nbsp;document.getElementById('content').style.display='none';
&nbsp;&nbsp;document.getElementById('search-page').style.display='flex';
&nbsp;&nbsp;logo.classList.remove('return-mode');
}
/* ================= 网站提交 + 验证码 + 重复域名检查 ================= */
function showSubmit(){
&nbsp;&nbsp;showPage(`
&nbsp;&nbsp;&nbsp;&nbsp;<h2>网站提交</h2>
&nbsp;&nbsp;&nbsp;&nbsp;<form onsubmit="submitSite(event)">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<select id="c1" required></select>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<select id="c2" required></select>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input id="name" placeholder="网站名称" required>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input id="url" placeholder="https://example.com" required>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<textarea id="desc" placeholder="网站简介" required></textarea>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input id="hp" style="display:none" autocomplete="off" readonly>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div id="captchaQuestion" style="margin:10px 0;font-weight:bold;color:#1a73e8;"></div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input id="captchaAnswer" placeholder="请输入答案" required style="width:100%;padding:8px;margin:4px 0;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button>提交</button>
&nbsp;&nbsp;&nbsp;&nbsp;</form>
&nbsp;&nbsp;&nbsp;&nbsp;<p id="msg"></p>
&nbsp;&nbsp;`);
&nbsp;&nbsp;window.c1 = document.getElementById('c1');
&nbsp;&nbsp;window.c2 = document.getElementById('c2');
&nbsp;&nbsp;window.nameInput = document.getElementById('name');
&nbsp;&nbsp;window.urlInput = document.getElementById('url');
&nbsp;&nbsp;window.descInput = document.getElementById('desc');
&nbsp;&nbsp;window.hp = document.getElementById('hp');
&nbsp;&nbsp;window.msg = document.getElementById('msg');
&nbsp;&nbsp;window.captchaQuestion = document.getElementById('captchaQuestion');
&nbsp;&nbsp;window.captchaAnswer = document.getElementById('captchaAnswer');
&nbsp;&nbsp;initCats();
&nbsp;&nbsp;generateCaptcha();
&nbsp;&nbsp;logo.classList.add('return-mode');
}
/* ================= 隐私政策 ================= */
function showPrivacy(){
&nbsp;&nbsp;showPage(`
&nbsp;&nbsp;&nbsp;&nbsp;<h2>隐私政策</h2>
&nbsp;&nbsp;&nbsp;&nbsp;<p>最后更新日期：2025年12月17日</p>
&nbsp;&nbsp;&nbsp;&nbsp;<p>本站（www.523322.xyz）非常重视用户隐私保护。以下是我们隐私政策的说明：</p>
&nbsp;&nbsp;&nbsp;&nbsp;<h3>1. 收集的信息</h3>
&nbsp;&nbsp;&nbsp;&nbsp;<p>本站为纯静态导航网站，不收集任何个人身份信息（如姓名、邮箱、手机号等）。</p>
&nbsp;&nbsp;&nbsp;&nbsp;<p>当您使用“网站提交”功能时，我们仅收集您自愿提供的网站名称、URL和简介，用于审核后添加到导航列表。</p>
&nbsp;&nbsp;&nbsp;&nbsp;<h3>2. Cookie 和日志</h3>
&nbsp;&nbsp;&nbsp;&nbsp;<p>本站使用 Google AdSense 投放广告，可能通过 Cookie 记录匿名访问数据（如浏览页面、点击广告）以优化广告展示。这些数据由 Google 管理，详见 <a href="https://policies.google.com/privacy" target="_blank">Google 隐私政策</a>。</p>
&nbsp;&nbsp;&nbsp;&nbsp;<p>服务器日志可能记录 IP 地址、浏览器类型等，用于站点统计和安全防护，不用于个人追踪。</p>
&nbsp;&nbsp;&nbsp;&nbsp;<h3>3. 第三方服务</h3>
&nbsp;&nbsp;&nbsp;&nbsp;<p>本站使用 Google AdSense 和 Google Favicon 服务。这些第三方可能收集匿名数据，具体政策请参阅其官网。</p>
&nbsp;&nbsp;&nbsp;&nbsp;<h3>4. 数据安全</h3>
&nbsp;&nbsp;&nbsp;&nbsp;<p>我们采取合理措施保护提交数据，但互联网传输不存在绝对安全。</p>
&nbsp;&nbsp;&nbsp;&nbsp;<h3>5. 政策变更</h3>
&nbsp;&nbsp;&nbsp;&nbsp;<p>如有重大变更，我们将在本站更新隐私政策。</p>
&nbsp;&nbsp;&nbsp;&nbsp;<h3>6. 联系我们</h3>
&nbsp;&nbsp;&nbsp;&nbsp;<p>如对隐私有疑问，请通过本站“关于导航”页面联系管理员。</p>
&nbsp;&nbsp;&nbsp;&nbsp;<p>感谢您使用本站！</p>
&nbsp;&nbsp;`);
&nbsp;&nbsp;logo.classList.add('return-mode');
}
/* ================= 友情链接 ================= */
function showLinks(){
&nbsp;&nbsp;showPage(`<h2>友情链接</h2><div class="links">
&nbsp;&nbsp;&nbsp;&nbsp;<div class="card"><div class="text"><div class="name">虚位以待</div><div class="desc">欢迎交换友情链接</div></div></div>
&nbsp;&nbsp;</div>`);
&nbsp;&nbsp;logo.classList.add('return-mode');
}
/* ================= 关于导航 ================= */
function showAbout(){
&nbsp;&nbsp;showPage(`<h2>关于导航</h2>
&nbsp;&nbsp;&nbsp;&nbsp;<p>本站致力于收录优质、常用的网站资源。</p>
&nbsp;&nbsp;&nbsp;&nbsp;<p>所有网站均来源于人工整理与用户提交，经审核后上线。</p>
&nbsp;&nbsp;&nbsp;&nbsp;<p>如发现不良内容，可联系我们处理。</p>
&nbsp;&nbsp;`);
&nbsp;&nbsp;logo.classList.add('return-mode');
}
/* ================= 公共显示 ================= */
function showPage(html){
&nbsp;&nbsp;document.getElementById('search-page').style.display='none';
&nbsp;&nbsp;const c=document.getElementById('content'); c.style.display='block'; c.innerHTML=html;
}
/* ================= 验证码和分类初始化函数（保持不变） ================= */
function generateCaptcha() {
&nbsp;&nbsp;const a = Math.floor(Math.random() * 10) + 1;
&nbsp;&nbsp;const b = Math.floor(Math.random() * 10) + 1;
&nbsp;&nbsp;const operators = ['+', '-', '×'];
&nbsp;&nbsp;const op = operators[Math.floor(Math.random() * operators.length)];
&nbsp;&nbsp;let question, answer;
&nbsp;&nbsp;switch (op) {
&nbsp;&nbsp;&nbsp;&nbsp;case '+': question = `${a} + ${b} = ?`; answer = a + b; break;
&nbsp;&nbsp;&nbsp;&nbsp;case '-': question = `${a} - ${b} = ?`; answer = a - b; break;
&nbsp;&nbsp;&nbsp;&nbsp;case '×': question = `${a} × ${b} = ?`; answer = a * b; break;
&nbsp;&nbsp;}
&nbsp;&nbsp;captchaQuestion.textContent = `验证码：${question}`;
&nbsp;&nbsp;window.correctAnswer = answer;
}
function initCats(){
&nbsp;&nbsp;c1.innerHTML = '<option value="">请选择一级分类</option>';
&nbsp;&nbsp;data.forEach((cat, i) => {
&nbsp;&nbsp;&nbsp;&nbsp;const opt = document.createElement('option');
&nbsp;&nbsp;&nbsp;&nbsp;opt.value = i;
&nbsp;&nbsp;&nbsp;&nbsp;opt.textContent = cat.name;
&nbsp;&nbsp;&nbsp;&nbsp;c1.appendChild(opt);
&nbsp;&nbsp;});
&nbsp;&nbsp;c1.onchange = () => {
&nbsp;&nbsp;&nbsp;&nbsp;c2.innerHTML = '<option value="">请选择二级分类</option>';
&nbsp;&nbsp;&nbsp;&nbsp;if (c1.value !== '') {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[c1.value].subs.forEach(sub => {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const opt = document.createElement('option');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opt.textContent = sub.name;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2.appendChild(opt);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;};
}
/* ================= 提交处理 ================= */
function submitSite(e){
&nbsp;&nbsp;e.preventDefault();
&nbsp;&nbsp;if (hp && hp.value !== '') {
&nbsp;&nbsp;&nbsp;&nbsp;msg.textContent = '异常操作，已阻止';
&nbsp;&nbsp;&nbsp;&nbsp;return;
&nbsp;&nbsp;}
&nbsp;&nbsp;const userAnswer = parseInt(captchaAnswer.value.trim(), 10);
&nbsp;&nbsp;if (isNaN(userAnswer) || userAnswer !== window.correctAnswer) {
&nbsp;&nbsp;&nbsp;&nbsp;msg.textContent = '验证码错误，请重新计算';
&nbsp;&nbsp;&nbsp;&nbsp;generateCaptcha();
&nbsp;&nbsp;&nbsp;&nbsp;captchaAnswer.value = '';
&nbsp;&nbsp;&nbsp;&nbsp;return;
&nbsp;&nbsp;}
&nbsp;&nbsp;const submittedUrl = urlInput.value.trim();
&nbsp;&nbsp;if (!submittedUrl) {
&nbsp;&nbsp;&nbsp;&nbsp;msg.textContent = '请填写网站URL';
&nbsp;&nbsp;&nbsp;&nbsp;return;
&nbsp;&nbsp;}
&nbsp;&nbsp;// 检查一级域名重复
&nbsp;&nbsp;let submittedRoot = '';
&nbsp;&nbsp;try {
&nbsp;&nbsp;&nbsp;&nbsp;let hostname = new URL(submittedUrl).hostname.toLowerCase();
&nbsp;&nbsp;&nbsp;&nbsp;if (hostname.startsWith('www.')) hostname = hostname.slice(4);
&nbsp;&nbsp;&nbsp;&nbsp;const parts = hostname.split('.');
&nbsp;&nbsp;&nbsp;&nbsp;if (parts.length <= 2) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submittedRoot = hostname;
&nbsp;&nbsp;&nbsp;&nbsp;} else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const last = parts[parts.length - 1];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const secondLast = parts[parts.length - 2];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const countrySuffixes = ['cn', 'uk', 'jp', 'de', 'fr', 'au', 'br', 'ru', 'in', 'ca', 'it', 'es', 'nl', 'kr', 'tw', 'hk', 'sg'];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const publicSuffixes = ['com', 'net', 'org', 'gov', 'edu', 'co', 'ne', 'or', 'go', 'ac', 'mil', 'info', 'biz'];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (countrySuffixes.includes(last) && publicSuffixes.includes(secondLast) && parts.length >= 3) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submittedRoot = parts.slice(-3).join('.');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submittedRoot = parts.slice(-2).join('.');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;} catch {
&nbsp;&nbsp;&nbsp;&nbsp;msg.textContent = 'URL格式不正确';
&nbsp;&nbsp;&nbsp;&nbsp;return;
&nbsp;&nbsp;}
&nbsp;&nbsp;fetch(API)
&nbsp;&nbsp;&nbsp;&nbsp;.then(r => r.text())
&nbsp;&nbsp;&nbsp;&nbsp;.then(text => {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const parser = new DOMParser();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const doc = parser.parseFromString(text, 'text/xml');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const existingRootDomains = new Set();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.querySelectorAll('link').forEach(link => {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let url = link.getAttribute('url');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (url) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let hostname = new URL(url).hostname.toLowerCase();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (hostname.startsWith('www.')) hostname = hostname.slice(4);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const parts = hostname.split('.');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let root = '';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (parts.length <= 2) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root = hostname;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const last = parts[parts.length - 1];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const secondLast = parts[parts.length - 2];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const countrySuffixes = ['cn', 'uk', 'jp', 'de', 'fr', 'au', 'br', 'ru', 'in', 'ca', 'it', 'es', 'nl', 'kr', 'tw', 'hk', 'sg'];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const publicSuffixes = ['com', 'net', 'org', 'gov', 'edu', 'co', 'ne', 'or', 'go', 'ac', 'mil', 'info', 'biz'];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (countrySuffixes.includes(last) && publicSuffixes.includes(secondLast) && parts.length >= 3) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root = parts.slice(-3).join('.');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root = parts.slice(-2).join('.');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (root) existingRootDomains.add(root);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} catch {}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (existingRootDomains.has(submittedRoot)) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert('此一级域名已存在（包括二级域名如 pan.baidu.com 等），请勿重复提交！');
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg.textContent = '重复域名，提交已阻止';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generateCaptcha();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const site = {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cat1: c1.options[c1.selectedIndex]?.text || '',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cat2: c2.options[c2.selectedIndex]?.text || '',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: nameInput.value.trim(),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url: submittedUrl,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desc: descInput.value.trim()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!site.cat1 || !site.cat2 || !site.name || !site.url || !site.desc) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg.textContent = '请填写完整信息并选择分类';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generateCaptcha();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg.textContent = '提交中...';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fetch('/api/submit', {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method: 'POST',
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;headers: {'Content-Type': 'application/json'},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body: JSON.stringify(site)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.then(r => r.text())
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.then(text => {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (text.includes('成功')) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg.textContent = '提交成功，等待管理员审核';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.target.reset();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generateCaptcha();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1.selectedIndex = 0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2.innerHTML = '<option value="">请选择二级分类</option>';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg.textContent = '提交失败：' + text;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generateCaptcha();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.catch(() => {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg.textContent = '网络错误，请重试';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generateCaptcha();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});
&nbsp;&nbsp;&nbsp;&nbsp;})
&nbsp;&nbsp;&nbsp;&nbsp;.catch(() => {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg.textContent = '检查重复时出错，请重试';
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generateCaptcha();
&nbsp;&nbsp;&nbsp;&nbsp;});
}
</script>
</body>
</html>
