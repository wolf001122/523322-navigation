<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>网址导航 - 实用资源站</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&family=Material+Icons&display=optional" rel="stylesheet">

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9474229114991789"
          crossorigin="anonymous"></script>

  <style>
    body { margin:0; font-family:'Roboto',Arial,sans-serif; background:#f1f3f4; display:flex; height:100vh; overflow:hidden; }
    .sidebar { width:256px; background:#fff; box-shadow:2px 0 8px rgba(0,0,0,0.12); position:fixed; height:100%; overflow-y:auto; z-index:10; transition:width 0.3s; }
    .sidebar-header { padding:24px 16px; font-size:20px; color:#5f6368; border-bottom:1px solid #e0e0e0; text-align:center; font-weight:500; }
    .sidebar-menu { list-style:none; padding:0; margin:0; }
    .sidebar-menu li a { display:flex; align-items:center; padding:12px 24px; color:#5f6368; text-decoration:none; font-size:14px; transition:all 0.2s; border-left:3px solid transparent; }
    .sidebar-menu li a:hover { background:#f1f3f4; border-left-color:#4285f4; }
    .sidebar-menu li a.active { background:#e8f0fe; color:#4285f4; font-weight:500; border-left-color:#4285f4; }
    .sidebar-menu li a .material-icons { margin-right:24px; font-size:24px; color:#5f6368; }
    .sidebar-menu li a.active .material-icons { color:#4285f4; }

    .main-content { margin-left:256px; flex:1; display:flex; flex-direction:column; transition:margin-left 0.3s; }
    .top-bar { background:#fff; height:64px; box-shadow:0 2px 4px rgba(0,0,0,0.1); display:flex; align-items:center; justify-content:center; padding:0 24px; z-index:5; }
    .top-bar .ad-container { width:728px; height:90px; display:flex; align-items:center; justify-content:center; }

    .content-frame { flex:1; width:100%; border:none; background:#f1f3f4; opacity:0; transition:opacity 0.4s ease; }
    .content-frame.loaded { opacity:1; }

    .ad-side { position:fixed; right:24px; top:100px; width:300px; height:600px; box-shadow:0 4px 20px rgba(0,0,0,0.1); border-radius:12px; overflow:hidden; z-index:5; }

    @media (max-width:1200px) {
      .sidebar { width:72px; }
      .sidebar-header { font-size:0; }
      .sidebar-menu li a span { display:none; }
      .sidebar-menu li a .material-icons { margin:0 auto; }
      .main-content { margin-left:72px; }
      .ad-side { display:none; }
    }
  </style>
</head>
<body>
  <!-- 左侧菜单 -->
  <div class="sidebar">
    <div class="sidebar-header">网址导航</div>
    <ul class="sidebar-menu">
      <li><a href="javascript:void(0)" onclick="loadDefault()" class="active"><span class="material-icons">search</span><span>搜索首页</span></a></li>
      <div id="dynamicCategories"></div>
      <li><a href="submit.html" target="contentFrame"><span class="material-icons">add_box</span><span>网站提交</span></a></li>
      <li><a href="javascript:void(0)" onclick="loadFriendlyLinks()"><span class="material-icons">link</span><span>友情链接</span></a></li>
      <li><a href="javascript:void(0)" onclick="loadAbout()"><span class="material-icons">info</span><span>关于导航</span></a></li>
    </ul>
  </div>

  <!-- 主内容区 -->
  <div class="main-content">
    <div class="top-bar">
      <div class="ad-container">
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-9474229114991789"
             data-ad-format="auto"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      </div>
    </div>
    <iframe name="contentFrame" class="content-frame" onload="this.classList.add('loaded')"></iframe>
  </div>

  <!-- 右侧广告 -->
  <div class="ad-side">
    <ins class="adsbygoogle"
         style="display:inline-block;width:300px;height:600px"
         data-ad-client="ca-pub-9474229114991789"
         data-ad-format="auto"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
  </div>

  <script>
    let categories = [];

    async function loadData() {
      try {
        const res = await fetch('/api/data');
        const xml = await res.text();
        const parser = new DOMParser();
        const doc = parser.parseFromString(xml, 'text/xml');

        categories = Array.from(doc.querySelectorAll('category')).map(cat => ({
          name: cat.getAttribute('name'),
          subcategories: Array.from(cat.querySelectorAll('subcategory')).map(sub => ({
            name: sub.getAttribute('name'),
            links: Array.from(sub.querySelectorAll('link')).map(l => ({
              name: l.getAttribute('name'),
              url: l.getAttribute('url'),
              desc: l.getAttribute('desc') || '',
              icon: l.getAttribute('icon') || ''
            }))
          })) || [{ name: '默认子分类', links: [] }]
        }));

        renderSidebar();
        loadDefault();
      } catch (e) {
        console.error('加载数据失败', e);
      }
    }

    function renderSidebar() {
      const container = document.getElementById('dynamicCategories');
      container.innerHTML = '';
      categories.forEach((cat, idx) => {
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = 'javascript:void(0)';
        a.innerHTML = `<span class="material-icons">folder</span><span>${cat.name}</span>`;
        a.onclick = () => loadCategory(idx);
        li.appendChild(a);
        container.appendChild(li);
      });
    }

    function loadDefault() {
      highlightMenu(event.target);
      const frame = document.querySelector('iframe');
      frame.contentDocument.open();
      frame.contentDocument.write(`
        <!DOCTYPE html>
        <html><head><meta charset="UTF-8"><style>
          body { margin:0; background:#f1f3f4; font-family:'Roboto',Arial,sans-serif; display:flex; align-items:center; justify-content:center; height:100vh; }
          .search-box { width:70%; max-width:900px; display:flex; box-shadow:0 8px 25px rgba(0,0,0,0.15); border-radius:30px; overflow:hidden; background:white; }
          input { flex:1; padding:24px; font-size:22px; border:none; outline:none; }
          select { padding:24px; font-size:18px; border:none; border-left:1px solid #eee; background:white; }
          button { padding:24px 48px; background:#4285f4; color:white; font-size:20px; border:none; cursor:pointer; }
          button:hover { background:#3367d6; }
        </style></head>
        <body>
          <div class="search-box">
            <input type="text" id="q" placeholder="请输入搜索内容..." onkeydown="if(event.keyCode==13) search()">
            <select id="engine">
              <option value="baidu">百度</option>
              <option value="google">Google</option>
              <option value="bing">Bing</option>
              <option value="so">360搜索</option>
            </select>
            <button onclick="search()">搜索</button>
          </div>
          <script>
            function search() {
              const q = document.getElementById('q').value.trim();
              if (!q) return;
              const engine = document.getElementById('engine').value;
              let url = '';
              switch(engine){
                case 'baidu': url = 'https://www.baidu.com/s?wd=' + encodeURIComponent(q); break;
                case 'google': url = 'https://www.google.com/search?q=' + encodeURIComponent(q); break;
                case 'bing': url = 'https://www.bing.com/search?q=' + encodeURIComponent(q); break;
                case 'so': url = 'https://www.so.com/s?q=' + encodeURIComponent(q); break;
              }
              window.open(url, '_blank');
            }
          </script>
        </body></html>
      `);
      frame.contentDocument.close();
    }

    function loadCategory(idx) {
      highlightMenu(event.target);
      const cat = categories[idx];
      let html = `<!DOCTYPE html><html><head><meta charset="UTF-8"><style>
        body { margin:0; background:#f1f3f4; padding:40px; font-family:'Roboto',Arial,sans-serif; }
        h2 { font-size:28px; color:#333; margin-bottom:40px; text-align:center; }
        .sub-title { font-size:22px; color:#4285f4; margin:50px 0 20px; padding-bottom:10px; border-bottom:2px solid #eee; }
        .grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:24px; }
        .card { background:#fff; padding:24px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.08); display:flex; flex-direction:column; gap:12px; transition:0.3s; }
        .card:hover { transform:translateY(-8px); box-shadow:0 12px 30px rgba(0,0,0,0.15); }
        .card img { width:48px; height:48px; object-fit:contain; border-radius:8px; }
        .card a { font-size:18px; font-weight:500; color:#333; text-decoration:none; }
        .card a:hover { color:#4285f4; }
        .card .desc { font-size:14px; color:#666; }
      </style></head><body><h2>${cat.name}</h2>`;

      cat.subcategories.forEach(sub => {
        if (sub.links.length > 0) {
          html += `<div class="sub-title">${sub.name}</div><div class="grid">`;
          sub.links.forEach(link => {
            html += `<div class="card">
              ${link.icon ? `<img src="${link.icon}" alt="${link.name}">` : '<img src="https://via.placeholder.com/48?text=ICON" alt="图标">'}
              <a href="${link.url}" target="_blank">${link.name}</a>
              <div class="desc">${link.desc}</div>
            </div>`;
          });
          html += `</div>`;
        }
      });

      html += `</body></html>`;

      const frame = document.querySelector('iframe');
      frame.contentDocument.open();
      frame.contentDocument.write(html);
      frame.contentDocument.close();
    }

    function highlightMenu(el) {
      document.querySelectorAll('.sidebar-menu a').forEach(a => a.classList.remove('active'));
      el.closest('a').classList.add('active');
    }

    function loadFriendlyLinks() {
      highlightMenu(event.target);
      const frame = document.querySelector('iframe');
      frame.contentDocument.open();
      frame.contentDocument.write(`
        <!DOCTYPE html><html><head><meta charset="UTF-8"><style>
          body { margin:0; background:#f1f3f4; padding:40px; text-align:center; font-family:'Roboto',Arial,sans-serif; }
          h2 { font-size:28px; color:#333; }
          p { font-size:16px; color:#5f6368; max-width:800px; margin:40px auto; line-height:1.8; }
        </style></head><body>
          <h2>友情链接</h2>
          <p>暂无友情链接，欢迎交换友链！</p>
        </body></html>
      `);
      frame.contentDocument.close();
    }

    function loadAbout() {
      highlightMenu(event.target);
      const frame = document.querySelector('iframe');
      frame.contentDocument.open();
      frame.contentDocument.write(`
        <!DOCTYPE html><html><head><meta charset="UTF-8"><style>
          body { margin:0; background:#f1f3f4; padding:40px; text-align:center; font-family:'Roboto',Arial,sans-serif; }
          h2 { font-size:28px; color:#333; }
          p { font-size:16px; color:#5f6368; max-width:800px; margin:30px auto; line-height:1.8; }
        </style></head><body>
          <h2>关于导航</h2>
          <p>吾爱三三两两导航站是一个实用资源集合网站，致力于提供优质工具与资源链接。</p>
          <p>版本：1.0 | 更新：2025-12-14</p>
        </body></html>
      `);
      frame.contentDocument.close();
    }

    loadData();
  </script>
</body>
</html>
